# -*- coding: utf-8 -*-
"""
牛顿三次插值
"""

import numpy as np
import matplotlib.pyplot as plt

def _2_5(X, Y, x):
    for i in range(len(X)):
        if X[i] > x:
            break
    x0, y0 = X[i-1], Y[i-1]
    x1, y1 = X[i], Y[i]
    x2, y2 = X[i+1], Y[i+1]
    d1y1, d1y2 = (y1 - y0)/(x1 - x0), (y2 - y1)/(x2 - x1)
    d2y = (d1y2 - d1y1)/(x2 - x1)
    t = x - X[i-1]
    y = y0 + d1y1*t + d2y*t*(t-1)/2
    return y


X = [10, 11, 12, 13, 14]
Y = [2.3026, 2.3979, 2.4849, 2.5649, 2.6391]
x = 11.5

# =============================================================================
# 测试例题
# print(_2_5(X, Y, x))
# =============================================================================
   

# =============================================================================
# 绘图显示 
# xx = np.arange(min(X)+0.1, max(X)-1, 0.1)
# yy = np.array([_2_5(X, Y, x) for x in xx])
# plt.plot(X, Y, 'o')
# plt.plot(xx, yy, '-')
# plt.title('yy')
# plt.show()
# =============================================================================
